# 说一下从 url 输入到返回请求的过程

## 步骤

## 问题

### encodeURIComponent 比 encodeURI 有什么区别

有时候我们在 url 跳转的时候往往会携带参数，参数中可能会包含一些特殊字符，例如：空格，下划线，加号…，这时候对后台或者前台解析的时候就读取不到这些特殊字符存在，这个时候我们就需要对特殊字符进行编码。
下面针对 encodeURI 和 encodeURIComponent 做个比较：
相同点：都可以对 url 进行一个编码；
区别：encodeURI()不会对本身属于 URI 的特殊字符进行编码，例如冒号、正斜杠、问号和井字号；而 encodeURIComponent()则会对它发现的任何非标准字符进行编码。

适用场景：URL 编码
详细场景：

1. encodeURI：适用于 url 跳转时。
2. encodeURIComponent：适用于 url 作为参数传递时。
3. 注意：当 url 作为参数传递时如果没有用 encodeURIComponent 进行编码，往往会造成传递时 url 中的特殊字符丢失。

### dns 解析流程，并且 html 如何做 dns 优化

1. 器中输入https://www.baidu.com 域名，操作系统会先查 hosts 件是否有记录，有的话就会把相对应映射的 IP 返回。
2. hosts 文件没有就去查本地 dns 解析器有没有缓存。
3. 然后就去找我们计算机上配置的 dns 服务器上有或者有缓存，就返回
4. 还没有的话就去找根 DNS 服务器(全球 13 台，固定 ip 地址)，然后判断.com 域名是哪个服务器管理，如果无法解析，就查找.baidu.com 服务器是否能解析，直到查到 www.baidu.com 的 IP 地址

解析顺序

1） 浏览器缓存

当用户通过浏览器访问某域名时，浏览器首先会在自己的缓存中查找是否有该域名对应的 IP 地址（若曾经访问过该域名且没有清空缓存便存在）；

2） 系统缓存

当浏览器缓存中无域名对应 IP 则会自动检查用户计算机系统 Hosts 文件 DNS 缓存是否有该域名对应 IP；

3） 路由器缓存

当浏览器及系统缓存中均无域名对应 IP 则进入路由器缓存中检查，以上三步均为客服端的 DNS 缓存；

4） ISP（互联网服务提供商）DNS 缓存

当在用户客服端查找不到域名对应 IP 地址，则将进入 ISP DNS 缓存中进行查询。比如你用的是电信的网络，则会进入电信的 DNS 缓存服务器中进行查找；

5） 根域名服务器

当以上均未完成，则进入根服务器进行查询。全球仅有 13 台根域名服务器，1 个主根域名服务器，其余 12 为辅根域名服务器。根域名收到请求后会查看区域文件记录，若无则将其管辖范围内顶级域名（如.com）服务器 IP 告诉本地 DNS 服务器；

6） 顶级域名服务器

顶级域名服务器收到请求后查看区域文件记录，若无则将其管辖范围内主域名服务器的 IP 地址告诉本地 DNS 服务器；

7） 主域名服务器

主域名服务器接受到请求后查询自己的缓存，如果没有则进入下一级域名服务器进行查找，并重复该步骤直至找到正确纪录；

8）保存结果至缓存

本地域名服务器把返回的结果保存到缓存，以备下一次使用，同时将该结果反馈给客户端，客户端通过这个 IP 地址与 web 服务器建立链接。

前端的 dns 优化，可以在 html 页面头部写入 dns 缓存地址，比如

```html
<meta http-equiv="x-dns-prefetch-control" content="on" />
<link rel="dns-prefetch" href="http://bdimg.share.baidu.com" />
```
