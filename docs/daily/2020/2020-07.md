# 2020-07

我自横刀向天笑，去留肝胆两昆仑。

## 2020-07-15

- 生活
- 身体健康
- 工作方面
- 个人能力
- 总结复盘

1.  vue-ssr 的复习，以 vue-hackernews-2.0 源码为基础，尝试全面掌握核心。

    1.  `FriendlyErrorsPlugin`插件是友好错误提示插件
    2.  `nodeExternals`插件
        请注意，在 externals 选项中，我们将 CSS 文件列入白名单。这是因为从依赖模块导入的 CSS 还应该由 webpack 处理。如果你导入依赖于 webpack 的任何其他类型的文件（例如 _.vue, _.sass），那么你也应该将它们添加到白名单中。

        如果你使用 runInNewContext: 'once' 或 runInNewContext: true，那么你还应该将修改 global 的 polyfill 列入白名单，例如 babel-polyfill。这是因为当使用新的上下文模式时，**server bundle 中的代码具有自己的 global 对象。**由于在使用 Node 7.6+ 时，在服务器并不真正需要它，所以实际上只需在客户端 entry 导入它。

    3.  复习了 promise 的原理，并且帮我理解了一个非常重要的场景

        ```js
        const readyPromise = new Promise(r => {
          ready = r;
        });
        const update = () => {
          if (bundle && clientManifest) {
            ready();
            cb(bundle, {
              template,
              clientManifest
            });
          }
        };
        ```

        ```js
        app.get(
          "*",
          isProd
            ? render
            : (req, res) => {
                readyPromise.then(() => render(req, res));
              }
        );
        ```

        在参考[promise](@/docs/interview/js/promise.md)之后，我意识到，`readyPromise.then(() => render(req, res));`不会立刻执行，什么时候 run 呢？在 promise 的 state 为 PENDING 的时候，那必须是 resolve 被调用的时候，就是 ready 被调用的时候。只要 promise 的 state 不为 PENDING ，那么`readyPromise.then(() => render(req, res));`可以无限次被立即触发执行。这个使用场景发生在非常底层的逻辑应用上，比如一个 sdk 的异步加载，那么加载之前触发的 sdk 接口需要保存在队列中，等 sdk 加载完成之后一一触发，这个可以用 promise 去解决，promise 内部就有队列可以去存储调用的 sdk 接口列表，在确认 sdk 加载完成之后，立即触发队列的接口任务。

## 2020-07-16

- 生活
- 身体健康
- 工作方面
- 个人能力

1. 完成 vue-hackernews-2.0 源码的研读

   1. `const VueSSRServerPlugin = require('vue-server-renderer/server-plugin')`的作用
      网络并无详解，估计要看源码，这是将服务器的整个输出，构建为单个 JSON 文件的插件。默认文件名为 `vue-ssr-server-bundle.json`
   2. clientManifest 的概念理解

   3. 数据预取和状态

      1. `var a = [{b:1},{b:2},{c:3}];console.log(a.map(x=>x.b).filter(_=>_)); // [1, 2]`
         这个代码非常有价值，通过 map 改变数组内数据结构，在通过 filter 过滤不符合要求的数据结构。


    4. client,server,文件变化三端的监听文件变化的处理不一样
        `chokidar`插件专门处理文件变化，这里处理`template.html`
        无法理解client和server的监听手段不一样

    5.  Firebase

- 总结复盘

## 2020-07-20

- 生活
- 身体健康
- 工作方面

1. 完成 p6 接口转中台
   1. jenkins 搭建<daily-status />
   2. 中台测试环境数据录入<daily-status />
   3. 项目结构调整，适应各环境部署配置
      1. 双域名接口情况处理<daily-status />
         无法直接 copyP5 的结构调整经验，因为要保留原有的接口
         顺利解决，经分析只需要保留一个 op 的登录接口，其他均使用中台接口，然后 op 登录接口可以单独处理。
      2. QT 升级的影响
         P6 是 QT 升级版
      3. 接口 301 处理
         原有配置有 301 权限处理，这里统一采用 loginFail 事件监听，这个要处理下，包括 P5 也要加上
   4. 部分接口转中台
   5.

- 个人能力

## 2020-07-21

- 生活
- 身体健康
- 工作方面

1. 完成 p6 接口转中台
   1. 项目结构调整，适应各环境部署配置
      1. QT 升级的影响
         P6 是 QT 升级版
      2. 接口 301 处理
         原有配置有 301 权限处理，这里统一采用 loginFail 事件监听，这个要处理下，包括 P5 也要加上
   2. 部分接口转中台
   3. 问题反馈模块

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读
   1. event
      子组件的$emit去触发定义在父组件中的事件，但其实是触发子组件自身的event事件，在子组件初始化event的过程中，会把父组件的自定义事件也保存下来，$emit 的时候会去里面寻找，
      之所以有父子组件通信的说法，是因为 event 中的事件方法是在父组件中定义的，只是保存了一份在子组件中去触发。

- 总结复盘

1. 原型/继承知识点研读

- 总结复盘

## 2020-07-23

- 生活
- 身体健康
- 工作方面

1. 完成 p6 上线<daily-status />
2. jssdkdemo 页面引用的 vue 的 cdn 改成本地
3. 采集服务的策略下发数据太长，改为弹窗显示全部，表格最多显示 3 行，同时设置其他表头的宽度
4. 采集服务的功能卖点时间段限定设置
5. 采集服务的表格都加上遮罩层
   但是如果是数据量大的 ui 渲染而不是接口耗时，遮罩层如何处理呢？\$nextTick
6. 算量平台知识问答排行榜接口调整，并且部署 aecore-test 环境测试<daily-status />
7. 用户算量平台网页加载不出来<daily-status />
   因为之前公司出现过类似的问题，远程一下就定位和华为云 cdn 有关，后来定位是用户电脑无法解析华为云的 cdn，就是 aecore-static.glodon.com，
   所以在网络中心设置 dns 服务器为：202.106.0.20,192.168.1.1。然后重启电脑即可。
8. 联系华为云人员解决 cdn 不刷新的问题
9. 会议讨论 aecore 上接入问题反馈的相关细节<daily-status />

   1. url 模板 url?pcode=xxx&&token=用户 token

   2. iframe 内部通知 session 过期

   3. 新干线 下载 gtj2018

   4. 判断是否登录，未登录要跳转到登录页，登录成功在跳转回原来的页面

   5. 控制台的入口放在导航上，没有登录的要求了

   6. 窗体尺寸：680 \* 700

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读

- 总结复盘

1. 原型/继承知识点研读

- 总结复盘

## 2020-07-24

- 生活
- 身体健康
- 工作方面

1. jssdkdemo 页面引用的 vue 的 cdn 改成本地
2. 采集服务的策略下发数据太长，改为弹窗显示全部，表格最多显示 3 行，同时设置其他表头的宽度<daily-status />
3. 采集服务的功能埋点时间段限定设置<daily-status />
4. 采集服务的表格都加上遮罩层
   但是如果是数据量大的 ui 渲染而不是接口耗时，遮罩层如何处理呢？\$nextTick
5. 联系华为云人员解决 cdn 不刷新的问题<daily-status />
   问题解决，华为人员将 cdn 刷新上限提升了 10 倍，之所以有这个问题是因为华为云账号分很多子账号，别的人刷新太狠达到上限影响了我。
6. P6 的弹窗 UI 颜色和 P5 一样，但是应该修正过，得看下 git 日志

aecore 官网我们嵌套的

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读

- 总结复盘

1. 原型/继承知识点研读

- 总结复盘

## 2020-07-27

- 生活
- 身体健康
- 工作方面

1.

aecore 官网我们嵌套的

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读
   插槽和作用域插槽的区别，子组件的延迟创建，一个在父组件就创建好，挂载到子组件，一个是在子组件渲染的时候才去延迟创建，这样就能获得子组件的参数了。

- 总结复盘

1. 原型/继承知识点研读

- 总结复盘

## 2020-07-28

- 生活
- 身体健康
- 工作方面

1. 14:00-16:00 需求设计会
2. 16:00-16:30 和刘卓确认 aecore 问题反馈的具体实现细节，支持匿名用户使用公共账户登录，后期公共账户的登录使用缓存，
3. 16:30-17:00 aecore 测试活动完成
4.

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读
   keepalive 10:30-11:35
   transition 11:35-11:50

- 总结复盘

1. 原型/继承知识点研读

- 总结复盘

## 2020-07-29

- 生活
- 身体健康
- 工作方面

1. P6 UI 修复，bug 修复，并上线正式环境<daily-status />
2. 问题反馈部署新的环境
3. 采集服务敬请期待页面
4. 装饰线上证书问题处理<daily-status />

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读
   keepalive 10:30-11:35
   transition 11:35-11:50L

- 总结复盘

1. 原型/继承知识点研读

- 总结复盘

## 2020-07-30

- 生活
- 身体健康
- 工作方面

1. P6 UI 二次修复，并上线正式环境
2. 采集服务公告页面部署<daily-status />17:00——17:30
3. 采集服务提示文案添加
4. 问题反馈页面部署新网址 14:30——18:00
5. 算量平台图片展示变形的问题<daily-status />17:30——18:00
   用户现场看了下，原来是中台上传图片的时候就有问题了，图片加了阿里云的截取参数，但现在是华为云。

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读
   transition 10:00-11:30
   transition-group 有个计算回溯的概念，发生元素改变的时候，立即计算改变之后的元素位置，然后强制回溯到未改变之前，然后开始元素移动动画。

   vue-router

- 总结复盘

## 2020-07-30

- 生活
- 身体健康
- 工作方面

1. P6 UI 二次修复，并上线正式环境
2. 采集服务公告页面部署
3. 采集服务提示文案添加

- 个人能力

1. 原型/继承知识点研读

2. vuejs 源码研读
   vue-router 10:20-11:40
   install
   matcher

3. vue-router 官网
   基础 15:00-16:10
   进阶 16:10-17:10

- 总结复盘
